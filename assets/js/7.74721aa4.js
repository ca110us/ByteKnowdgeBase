(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{176:function(t,a,e){"use strict";e.r(a);var v=e(0),_=Object(v.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"content"},[e("h1",{attrs:{id:"rest-api-标准"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#rest-api-标准","aria-hidden":"true"}},[t._v("#")]),t._v(" REST API 标准")]),t._v(" "),e("p",[t._v("本标准的定义以实用性为主，参考了Facebook等知名网站API实现方式。")]),t._v(" "),e("h2",{attrs:{id:"数据格式"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#数据格式","aria-hidden":"true"}},[t._v("#")]),t._v(" 数据格式")]),t._v(" "),e("p",[t._v("以JSON作为唯一的REST API数据格式。")]),t._v(" "),e("h2",{attrs:{id:"http动词"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#http动词","aria-hidden":"true"}},[t._v("#")]),t._v(" HTTP动词")]),t._v(" "),e("p",[t._v("HTTP的动词有：")]),t._v(" "),e("ul",[e("li",[t._v("GET：从服务器取出资源（一项或多项）。")]),t._v(" "),e("li",[t._v("POST：在服务器新建一个资源。")]),t._v(" "),e("li",[t._v("PUT：在服务器更新资源（客户端提供改变后的完整资源）。")]),t._v(" "),e("li",[t._v("PATCH：在服务器更新资源（客户端提供改变的属性）。")]),t._v(" "),e("li",[t._v("DELETE：从服务器删除资源。")]),t._v(" "),e("li",[t._v("HEAD：获取资源的元数据。")]),t._v(" "),e("li",[t._v("OPTIONS：获取信息，关于资源的哪些属性是客户端可以改变的。")])]),t._v(" "),e("p",[t._v("以上动词，在API中我们应只使用GET、POST、DELETE。PUT、PATCH用POST替代，因为通常人们会搞不清楚POST、PUT的区别，所以索性只使用POST这个词，来表示资源的创建/更新。")]),t._v(" "),e("h2",{attrs:{id:"版本号"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#版本号","aria-hidden":"true"}},[t._v("#")]),t._v(" 版本号")]),t._v(" "),e("p",[t._v("应当将API的版本号放入URL中，比如：")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("https://example.com/api/v1/\n")])])]),e("h2",{attrs:{id:"响应"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#响应","aria-hidden":"true"}},[t._v("#")]),t._v(" 响应")]),t._v(" "),e("p",[t._v("服务器端API程序能返回的响应，状态码均应为200。非200的请求，均为异常请求，比如：API服务器宕机、服务内部错误、网络异常等。")]),t._v(" "),e("p",[t._v("API调用方程序应根据返回的数据中，是否含"),e("code",[t._v("error")]),t._v("这个key，来判定本次API请求操作是否成功。")]),t._v(" "),e("h3",{attrs:{id:"成功的响应"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#成功的响应","aria-hidden":"true"}},[t._v("#")]),t._v(" 成功的响应")]),t._v(" "),e("p",[t._v("单个资源的获取、创建、更新，应响应完整的资源结构体，比如创建或更新一个用户后应返回完整的用户结构体：")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v('{\n    "id": 1,\n    "username": "admin",\n    "email": "admin@example.com",\n    "created_time": "2016-09-21T00:27:47+08:00"\n}\n')])])]),e("p",[t._v("资源结构体中的key，应均为小写字母，多个单词之间用下划线隔开。如果某个key表示时间，那么应返回ISO 8601格式标准的时间。")]),t._v(" "),e("p",[t._v("获取多个资源的请求，有分页的应响应如下结构体：")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v('{\n    "data": [\n        {"key1": "value1", "key2": "value2"},\n        {"key1": "value1", "key2": "value2"},\n        {"key1": "value1", "key2": "value2"}\n    ],\n    "paging": [\n        "total": 100,\n        "offset": 50,\n        "limit": 10\n    ]\n}\n')])])]),e("p",[e("code",[t._v("total")]),t._v("表示总共有多少个资源，"),e("code",[t._v("offset")]),t._v("表示本次响应返回的结果集是从第几个资源起的序号，"),e("code",[t._v("limit")]),t._v("表次本次响应返回的结果集最大个行数。")]),t._v(" "),e("p",[t._v("无分页的应响应如下结构体：")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v('[\n    {"key1": "value1", "key2": "value2"},\n    {"key1": "value1", "key2": "value2"},\n    {"key1": "value1", "key2": "value2"}\n]\n')])])]),e("h3",{attrs:{id:"失败的响应"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#失败的响应","aria-hidden":"true"}},[t._v("#")]),t._v(" 失败的响应")]),t._v(" "),e("p",[t._v("API请求操作失败应返回如下的结构体：")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v('{\n    "error": {\n        "message" : "错误描述信息。",\n        "code": "错误码（值为整形）"\n    }\n}\n')])])]),e("p",[t._v("每个接口的文档需明确指出当前接口可能会返回的每个错误码。错误码分通用错误码，及业务错误码。约定，通用错误码的取值范围应在1 ~ 100之间，100以上的为业务错误码，常用的通用错误码有：")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",[t._v("Code")]),t._v(" "),e("th",[t._v("Const")]),t._v(" "),e("th",[t._v("Description")]),t._v(" "),e("th",[t._v("HTTP Code")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[t._v("1")]),t._v(" "),e("td",[t._v("API_NOT_FOUND")]),t._v(" "),e("td",[t._v("API不存在")]),t._v(" "),e("td",[t._v("404")])]),t._v(" "),e("tr",[e("td",[t._v("2")]),t._v(" "),e("td",[t._v("BAD_REQUEST")]),t._v(" "),e("td",[t._v("请求报文格式不正确："),e("br"),t._v("1.请求体非json格式"),e("br"),t._v("2.未设置application/json头部")]),t._v(" "),e("td",[t._v("400")])]),t._v(" "),e("tr",[e("td",[t._v("3")]),t._v(" "),e("td",[t._v("INVALID_CREDENTIAL")]),t._v(" "),e("td",[t._v("Credential不正确:"),e("br"),t._v("1.Credential格式不正确 2. Credential签名不正确")]),t._v(" "),e("td",[t._v("401")])]),t._v(" "),e("tr",[e("td",[t._v("4")]),t._v(" "),e("td",[t._v("OVERDUE_CREDENTIAL")]),t._v(" "),e("td",[t._v("Credential已过期")]),t._v(" "),e("td",[t._v("401")])]),t._v(" "),e("tr",[e("td",[t._v("5")]),t._v(" "),e("td",[t._v("BANNED_CREDENTIALS")]),t._v(" "),e("td",[t._v("Credential对应的用户被禁止")]),t._v(" "),e("td",[t._v("401")])]),t._v(" "),e("tr",[e("td",[t._v("6")]),t._v(" "),e("td",[t._v("INTERNAL_SERVER_ERROR")]),t._v(" "),e("td",[t._v("服务内部错误，需联系管理员")]),t._v(" "),e("td",[t._v("500")])]),t._v(" "),e("tr",[e("td",[t._v("7")]),t._v(" "),e("td",[t._v("SERVICE_UNAVAILABLE")]),t._v(" "),e("td",[t._v("服务暂时下线，请稍后重试:"),e("br"),t._v("1.升级维护中"),e("br"),t._v("2.过载保护中"),e("br"),t._v("3.内部服务处理超时")]),t._v(" "),e("td",[t._v("503")])]),t._v(" "),e("tr",[e("td",[t._v("8")]),t._v(" "),e("td",[t._v("INVALID_ARGUMENT")]),t._v(" "),e("td",[t._v("参数缺失、参数不正确")]),t._v(" "),e("td",[t._v("422")])])])]),t._v(" "),e("h3",{attrs:{id:"注意事项"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#注意事项","aria-hidden":"true"}},[t._v("#")]),t._v(" 注意事项")]),t._v(" "),e("p",[t._v("校验类API要返回错误校验结果的，不应归类为API错误，应该按正常响应返回。")]),t._v(" "),e("p",[t._v("比如校验正确返回：")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v('{\n    "success": true\n}\n')])])]),e("p",[t._v("比如校验失败返回：")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v('{\n    "success": false,\n    "reason": {\n        "message" : "username is too long",\n        "type": "username_invalid"\n    }\n}\n')])])]),e("h2",{attrs:{id:"user-context"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#user-context","aria-hidden":"true"}},[t._v("#")]),t._v(" User Context")]),t._v(" "),e("p",[t._v("(todo)")]),t._v(" "),e("h2",{attrs:{id:"batch-request"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#batch-request","aria-hidden":"true"}},[t._v("#")]),t._v(" Batch Request")]),t._v(" "),e("p",[t._v("(todo)")])])}],!1,null,null,null);_.options.__file="rest-api.md";a.default=_.exports}}]);