(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{169:function(s,t,a){"use strict";a.r(t);var e=a(0),n=Object(e.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("div",{staticClass:"content"},[a("h1",{attrs:{id:"ubuntu-安全配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ubuntu-安全配置","aria-hidden":"true"}},[s._v("#")]),s._v(" Ubuntu 安全配置")]),s._v(" "),a("h2",{attrs:{id:"ssh加固"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ssh加固","aria-hidden":"true"}},[s._v("#")]),s._v(" SSH加固")]),s._v(" "),a("p",[s._v("编辑 "),a("code",[s._v("/etc/ssh/sshd_config")]),s._v(" 修改如下配置：")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("PasswordAuthentication no # 禁止密码登陆\nPermitRootLogin no # 禁止root登陆\n")])])]),a("p",[s._v("可通过以下shell修改：")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{attrs:{class:"token function"}},[s._v("sed")]),s._v(" -i "),a("span",{attrs:{class:"token string"}},[s._v("'s/^\\(#\\?\\s*PasswordAuthentication\\s.*\\)/PasswordAuthentication no/g'")]),s._v(" /etc/ssh/sshd_config\n"),a("span",{attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{attrs:{class:"token function"}},[s._v("sed")]),s._v(" -i "),a("span",{attrs:{class:"token string"}},[s._v("'s/^\\(#\\?\\s*PermitRootLogin\\s.*\\)/PermitRootLogin no/g'")]),s._v(" /etc/ssh/sshd_config\n"),a("span",{attrs:{class:"token function"}},[s._v("sed")]),s._v(" -n -e "),a("span",{attrs:{class:"token string"}},[s._v("'/^\\(#\\?\\s*PasswordAuthentication\\s.*\\)/p'")]),s._v(" -e "),a("span",{attrs:{class:"token string"}},[s._v("'/^\\(#\\?\\s*PermitRootLogin\\s.*\\)/p'")]),s._v(" /etc/ssh/sshd_config\n")])])]),a("p",[s._v("shell的最后一行输出了修改后的配置，请检查修改是否成功！")]),s._v(" "),a("p",[s._v("配置需在SSH服务重启后才能生效："),a("code",[s._v("service ssh restart")]),s._v("。")]),s._v(" "),a("h2",{attrs:{id:"防火墙配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#防火墙配置","aria-hidden":"true"}},[s._v("#")]),s._v(" 防火墙配置")]),s._v(" "),a("h3",{attrs:{id:"添加iptables规则"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#添加iptables规则","aria-hidden":"true"}},[s._v("#")]),s._v(" 添加iptables规则")]),s._v(" "),a("p",[s._v("以下为示例的iptables规则，请根据实际情况修改：")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("iptables -P INPUT ACCEPT\niptables -F INPUT\niptables -A INPUT -m conntrack --ctstate ESTABLISHED,RELATED -j ACCEPT\niptables -A INPUT -i lo -j ACCEPT\niptables -A INPUT -p TCP --dport 80 -j ACCEPT\niptables -A INPUT -p TCP -s "),a("span",{attrs:{class:"token punctuation"}},[s._v("{")]),s._v("JUMPSERVER_IP"),a("span",{attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" --dport 22 -j ACCEPT\niptables -A INPUT -p TCP -s "),a("span",{attrs:{class:"token punctuation"}},[s._v("{")]),s._v("ZABBIX_SERVER_IP"),a("span",{attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" --dport 10050 -j ACCEPT\niptables -A INPUT -p icmp -s "),a("span",{attrs:{class:"token punctuation"}},[s._v("{")]),s._v("JUMPSERVER_IP"),a("span",{attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" -j ACCEPT\niptables -P INPUT DROP\n")])])]),a("p",[s._v("建议：SSH 22端口的规则，设置2条及以上的规则，以免JUMPSERVER的单点故障，导致无法SSH登陆。")]),s._v(" "),a("h3",{attrs:{id:"iptables规则自动保存-加载："}},[a("a",{staticClass:"header-anchor",attrs:{href:"#iptables规则自动保存-加载：","aria-hidden":"true"}},[s._v("#")]),s._v(" iptables规则自动保存/加载：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("iptables-save "),a("span",{attrs:{class:"token operator"}},[s._v(">")]),s._v(" /etc/iptables.rules\n")])])]),a("h3",{attrs:{id:"网卡启动自动加载脚本-etc-network-if-pre-up-d-iptables"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#网卡启动自动加载脚本-etc-network-if-pre-up-d-iptables","aria-hidden":"true"}},[s._v("#")]),s._v(" 网卡启动自动加载脚本"),a("code",[s._v("/etc/network/if-pre-up.d/iptables")])]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{attrs:{class:"token keyword"}},[s._v("echo")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v("'#!/bin/sh\niptables-restore < /etc/iptables.rules\nexit 0'")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v(">")]),s._v(" /etc/network/if-pre-up.d/iptables\n")])])]),a("h3",{attrs:{id:"网卡卸载自动保存脚本-etc-network-if-post-down-d-iptables"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#网卡卸载自动保存脚本-etc-network-if-post-down-d-iptables","aria-hidden":"true"}},[s._v("#")]),s._v(" 网卡卸载自动保存脚本"),a("code",[s._v("/etc/network/if-post-down.d/iptables")])]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{attrs:{class:"token keyword"}},[s._v("echo")]),s._v(" "),a("span",{attrs:{class:"token string"}},[s._v("'#!/bin/sh\niptables-save -c > /etc/iptables.rules\nif [ -f /etc/iptables.rules ]; then\n  iptables-restore < /etc/iptables.rules\nfi\nexit 0'")]),s._v(" "),a("span",{attrs:{class:"token operator"}},[s._v(">")]),s._v(" /etc/network/if-post-down.d/iptables\n")])])]),a("h3",{attrs:{id:"加可执行权限："}},[a("a",{staticClass:"header-anchor",attrs:{href:"#加可执行权限：","aria-hidden":"true"}},[s._v("#")]),s._v(" 加可执行权限：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{attrs:{class:"token function"}},[s._v("chmod")]),s._v(" +x /etc/network/if-post-down.d/iptables\n"),a("span",{attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{attrs:{class:"token function"}},[s._v("chmod")]),s._v(" +x /etc/network/if-pre-up.d/iptables\n")])])])])}],!1,null,null,null);n.options.__file="linux-ubuntu-security.md";t.default=n.exports}}]);